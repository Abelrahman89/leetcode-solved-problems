package com.example.pathselect;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.IOException;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class TextToExcelConverter {

    public static void main(String[] args) {
        String inputFilePath = "C:Users/abdel/Downloads/test/tst.txt";
        String outputFilePath = "C:Users/abdel/Downloads/test/result";

        // Read the input text file
        List<String[]> data = new ArrayList<>();
        try (BufferedReader reader = new BufferedReader(new FileReader(inputFilePath))) {
            String line;
            while ((line = reader.readLine()) != null) {
                String[] rowData = line.split(",");
                data.add(rowData);
            }
        } catch (IOException e) {
            System.err.println("Failed to read file: " + e.getMessage());
            return;
        }

        // Write the data to the output Excel file
        try (OutputStream outputStream = new FileOutputStream(new File(outputFilePath));
             OutputStreamWriter writer = new OutputStreamWriter(outputStream, StandardCharsets.UTF_8);
             BufferedWriter bufferedWriter = new BufferedWriter(writer)) {

            // Write the header row to the Excel file
            String[] headerRow = {"Title", "Value"};
            String headerString = String.join("\t", headerRow);
            bufferedWriter.write(headerString);
            bufferedWriter.newLine();

            // Write the data rows to the Excel file
            for (String[] rowData : data) {
                String[] rowValues = {rowData[0], rowData[1]};
                String rowString = String.join("\t", rowValues);
                bufferedWriter.write(rowString);
                bufferedWriter.newLine();
            }

        } catch (IOException e) {
            System.err.println("Failed to write file: " + e.getMessage());
            return;
        }

        System.out.println("Excel file created successfully.");
    }

}
