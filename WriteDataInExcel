package com.example.pathselect;

import java.io.*;
import java.util.ArrayList;
import java.util.List;


public class TextToExcelConverter {

    public static void main(String[] args) {


        //System.out.print("Enter the path of the text file: ");
        String filePath = "C:Users/abdel/Downloads/test/tst.txt";//scanner.nextLine();



        List<String[]> data = new ArrayList<>();
        try (BufferedReader reader = new BufferedReader(new FileReader(filePath))) {
            String line;
            while ((line = reader.readLine()) != null) {
                String[] rowData = line.split(",");
                data.add(rowData);
            }
        } catch (IOException e) {
            System.err.println("Failed to read file: " + e.getMessage());
            return;
        }
        String outputFilePath ="C:Users/abdel/Downloads/test/result.xlsx" ;//scanner.nextLine();

        try (FileOutputStream outputStream = new FileOutputStream(new File(outputFilePath));
             OutputStreamWriter writer = new OutputStreamWriter(outputStream);
             BufferedWriter bufferedWriter = new BufferedWriter(writer)) {
             //Write the header row to the Excel file
            bufferedWriter.write("Title,Value");
            bufferedWriter.newLine();

            // Write the data rows to the Excel file
            for (String[] rowData : data) {
                String rowString = String.join(",", rowData);
                bufferedWriter.write(rowString);
                bufferedWriter.newLine();
            }
        } catch (IOException e) {
            System.err.println("Failed to write Excel file: " + e.getMessage());
            return;
        }

        System.out.println("Excel file created successfully.");
    }
}




